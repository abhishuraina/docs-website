---
title: 'Reference: Data dropping at gateway'
metaDescription: 'Understand the costs associated with using Pipeline Control.'
freshnessValidatedDate: never
---

Pipeline Control cloud rules and gateway rules sometimes work differently than each other, even when using identical NRQL definitions. 

When telemetry data is received by New Relic, it undergoes multiple transformations and enrichments before the data is assessed by cloud rules and stored in NRDB. But gateway rules run in your own infrastructure before data it’s transformed and enriched by New Relic. This difference in data schema and fidelity can result in gateway rules not working as expected.

When authoring gateway rules, make sure you reference this document while crafting your NRQL definition to convert or remove any attributes that operate differently in the gateway. This may be because attributes have a different name, or because they don’t exist at all. Use this document to search for the attributes that you’re using in your gateway rule NRQL definition to identify.

If an attribute has been renamed, simply use the renamed attribute in your NRQL instead of the original attribute. 

If an attribute is not available, consider using a cloud rule instead of a gateway rule.

## Go agent
### `analytic_event_data`

#### Attribute changes
<table> 
    <thead> 
        <tr> 
            <th>Original NRDB attribute</th>
            <th>Renamed gateway attribute</th>
            <th>NRQL support within gateway</th>
        </tr> 
    </thead> 
    <tbody> 
        <tr> 
            <td>None</td>
            <td>None</td>
            <td>N/A</td>
        </tr> 
    </tbody> 
</table>

#### Non-droppable attributes
<table> 
    <thead> 
        <tr> 
            <th>Event Type</th> 
            <th>Non-droppable attributes</th> 
        </tr> 
    </thead> 
    <tbody> 
        <tr> 
            <td>`analytic_event_data`</td> 
            <td>`appId`, `appName`, `containerId`, `entity.guid`, `entityGuid`, `host`, `realAgentId`, `transactionSubType`, `transactionType`</td> 
        </tr> 
    </tbody> 
</table>

#### Sample query
`DELETE priority FROM Transaction WHERE guid = 'c2906c2e8b9f11ff'`

### `custom_event_data`

#### Attribute changes
<table> 
    <thead> 
        <tr> 
            <th>Original NRDB attribute</th>
            <th>Renamed gateway attribute</th>
            <th>NRQL support within gateway</th>
        </tr> 
    </thead> 
    <tbody> 
        <tr> 
            <td>None</td>
            <td>None</td>
            <td>N/A</td>
        </tr> 
    </tbody> 
</table>

#### Non-droppable attributes
<table> 
    <thead> 
        <tr> 
            <th>Event type</th> 
            <th>Non-droppable attributes</th> 
        </tr> 
    </thead> 
    <tbody> 
        <tr> 
            <td>`custom_event_data`</td> 
            <td>`appId`, `appName`, `containerId`, `entityGuid`, `host`, `realAgentId`</td> 
        </tr> 
    </tbody> 
</table>

#### Sample query
`DELETE myString FROM my_event_type WHERE myFloat = 0.603`

### `error_data`

#### Attribute changes
<table> 
    <thead> 
        <tr> 
            <th>Original NRDB attribute</th>
            <th>Renamed gateway attribute</th>
            <th>NRQL support within gateway</th>
        </tr> 
    </thead> 
    <tbody> 
        <tr> 
            <td>None</td>
            <td>None</td>
            <td>N/A</td>
        </tr> 
    </tbody> 
</table>

#### Non-droppable attributes
<table> 
    <thead> 
        <tr> 
            <th>Event type</th> 
            <th>Non-droppable attributes</th> 
        </tr> 
    </thead> 
    <tbody> 
        <tr> 
            <td>`error_data`</td> 
            <td>`aggregateFacet`, `appId`, `appName`, `applicationIds`, `count`, `entity.guid`, `entityGuid`, `error.class`, `message`, `path`, `exceptionClass`, `fingerprint`, `id`, `message`, `realAgentId`, `storageId`, `timestamp`, `transactionName`, `transactionUiName`</td> 
        </tr> 
    </tbody> 
</table>

#### Sample query
`DELETE FROM ErrorTrace WHERE traceId = 'b366efe772fa6d1c8e0852558026c40e'`

### `error_event_data`

#### Attribute changes
<table> 
    <thead> 
        <tr> 
            <th>Original NRDB attribute</th>
            <th>Renamed gateway attribute</th>
            <th>NRQL support within gateway</th>
        </tr> 
    </thead> 
    <tbody> 
        <tr> 
            <td>None</td>
            <td>None</td>
            <td>N/A</td>
        </tr> 
    </tbody> 
</table>

#### Non-droppable attributes
<table> 
    <thead> 
        <tr> 
            <th>Event type</th> 
            <th>Non-droppable attributes</th> 
        </tr> 
    </thead> 
    <tbody> 
        <tr> 
            <td>`error_event_data`</td> 
            <td>`aggregateFacet`, `appId`, `appName`, `containerId`, `entity.guid`, `entityGuid`, `host`, `realAgentId`, `transactionUiName`</td> 
        </tr> 
    </tbody> 
</table>

#### Sample query
`DELETE FROM TransactionError WHERE error.message = 'my expected error message'`

### `metric_data`

#### Attribute changes
<table> 
    <thead> 
        <tr> 
            <th>Original NRDB attribute</th>
            <th>Renamed gateway attribute</th>
            <th>NRQL support within gateway</th>
        </tr> 
    </thead> 
    <tbody> 
        <tr> 
            <td>None</td>
            <td>None</td>
            <td>N/A</td>
        </tr> 
    </tbody> 
</table>

#### Non-droppable attributes
<table> 
    <thead> 
        <tr> 
            <th>Event type</th> 
            <th>Non-droppable attributes</th> 
        </tr> 
    </thead> 
    <tbody> 
        <tr> 
            <td>`metric_data`</td> 
            <td>`appId`, `appName`, `entity.guid`, `entityGuid`, `language`, `metricName`, `metricTimesliceName`, `newrelic.timeslice.value`, `scope`, `timestamp`</td> 
        </tr> 
    </tbody> 
</table>

#### Sample query
Not applicable. Drop rules are not supported for this event type.

### `span_event_data`

#### Attribute changes
<table>
    <thead>
        <tr>
            <th>Original NRDB attribute</th>
            <th>Renamed gateway attribute</th>
            <th>NRQL support within gateway</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>None</td>
            <td>None</td>
            <td>N/A</td>
        </tr>
    </tbody>
</table>

#### Non-droppable attributes
<table>
    <thead>
        <tr>
            <th>Event type</th>
            <th>Non-droppable attributes</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>`span_event_data`</td>
            <td>`appId`, `appName`, `containerId`, `duration.ms`, `entity.guid`, `entity.name`, `entityGuid`, `host`, `id`, `process.id`, `realAgentId`, `trace.id`</td>
        </tr>
    </tbody>
</table>


#### Sample query
`DELETE FROM Span WHERE name = 'WebTransaction/Go/GET /log'`

### `sql_trace_data`

#### Attribute changes
<table>
    <thead>
        <tr>
            <th>Original NRDB attribute</th>
            <th>Renamed gateway attribute</th>
            <th>NRQL support within gateway</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>None</td>
            <td>None</td>
            <td>N/A</td>
        </tr>
    </tbody>
</table>

#### Non-droppable attributes
<table>
    <thead>
        <tr>
            <th>Event type</th>
            <th>Non-droppable attributes</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>`sql_trace_data`</td>
            <td>`applicationIds`, `callCount`, `databaseMetricName`, `entity.guid`, `id`, `maxCallTime`, `minCallTime`, `path`, `realAgentId`, `sql`, `sqlId`, `storageId`, `timestamp`, `totalCallTime`, `uri`</td>
        </tr>
    </tbody>
</table>


#### Sample query
Not applicable. Drop rules are not supported for this event type.

### `transaction_sample_data`

<table>
    <thead>
        <tr>
            <th>Event type</th>
            <th>Original NRDB attribute</th>
            <th>Renamed gateway attribute</th>
            <th>NRQL support within gateway</th>
            <th>Non-droppable attributes</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>`transaction_sample_data`</td>
            <td>None</td>
            <td>None</td>
            <td>N/A</td>
            <td>`storageId`, `uri`, `path`, `agentRunId`, `applicationIds`, `duration`, `entity.guid`, `guid`, `id`, `protocolVersion`, `realAgentId`, `timestamp`</td>
        </tr>
    </tbody>
</table>


#### Sample query
Not applicable. Drop rules are not supported for this event type.

## Java agent

### `custom_event_data`
<table>
    <thead>
        <tr>
            <th>Event type</th>
            <th>Original NRDB attribute</th>
            <th>Renamed gateway attribute</th>
            <th>NRQL support within gateway</th>
            <th>Non-droppable attributes</th>
            <th>Sample NRQL query</th>

        </tr>
    </thead>
    <tbody>
        <tr>
            <td>`custom_event_data`</td>
            <td>None</td>
            <td>None</td>
            <td>N/A</td>
            <td>`entityGuid`, `appId`, `appName`, `containerId`, `host`, `realAgentId`</td>
            <td>`DELETE attr2 FROM MyCustomEvent WHERE attr1 = 'one'`</td>
        </tr>
    </tbody>
</table>


### `span_event_data`

<table>
    <thead>
        <tr>
            <th>Event type</th>
            <th>Original NRDB attribute</th>
            <th>Renamed gateway attribute</th>
            <th>NRQL support within gateway</th>
            <th>Non-droppable attributes</th>
            <th>Sample NRQL query</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>`span_event_data`</td>
            <td>None</td>
            <td>None</td>
            <td>N/A</td>
            <td>`trace.id`, `server.address`, `realAgentId`, `process.id`, `peer.hostname`, `peer.address`, `parent.id`, `id`, `host`, `entityGuid`, `entity.name`, `entity.guid`, `duration.ms`, `db.collection`, `instance`, `operation`, `statement`, `system`, `code.namespace`, `function`, `appId`, `appName`</td>
            <td>`DELETE FROM Span WHERE url_path = '/audit'`</td>
        </tr>
    </tbody>
</table>

To ensure effective data processing:
- Preserve all non-droppable attributes listed earlier.
- Use sample queries to manage records without compromising essential attribute integrity.

## Infrastructure agent

### `external_metric_api_infra`

<table>
    <thead>
        <tr>
            <th>Event type</th>
            <th>Original NRDB attribute</th>
            <th>Renamed gateway attribute</th>
            <th>NRQL support within gateway</th>
            <th>Non-droppable attributes</th>
            <th>Sample NRQL query</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>`gauge`</td>
            <td>`metrics.value`</td>
            <td>`metricName`</td>
            <td>`true`</td>
            <td>`newrelic.source (metricAPI), metricName : \{type, count, latest, max, min, sum\}` (for example, `redis_aof_rewrite_in_progress.type`)</td>
            <td>`DELETE FROM Metric WHERE metricName = 'redis_aof_rewrite_in_progress' AND value < 100`</td>
        </tr>
        <tr>
            <td>`summary`</td>
            <td>`metrics.value`, `interval.ms`</td>
            <td>`metricName`</td>
            <td>`true`</td>
            <td>`newrelic.source (metricAPI), metricName : \{type, count, max, min, sum\}` (for example, `redis_aof_rewrite_in_progress.type`)</td>
            <td>`DELETE FROM Metric WHERE scrapedTargetKind = 'user_provided'`</td>
        </tr>
        <tr>
            <td>`count`</td>
            <td>`metrics.value`, `interval.ms`</td>
            <td>`metricName`</td>
            <td>`true`</td>
            <td>`newrelic.source (metricAPI)`, `metricName : \{type, count\}` (for example, `redis_aof_rewrite_in_progress.type`)</td>
            <td>`DELETE FROM Metric WHERE instrumentation.name = 'nri-prometheus'`</td>
        </tr>
    </tbody>
</table>


### `infra_metrics_data`

<table>
    <thead>
        <tr>
            <th>Event type</th>
            <th>Original NRDB attribute</th>
            <th>Renamed gateway attribute</th>
            <th>NRQL support within gateway</th>
            <th>Non-droppable attributes</th>
            <th>Sample NRQL query</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>`SystemSample`</td>
            <td>`TBD`</td>
            <td>None</td>
            <td>N/A</td>
            <td>None</td>
            <td>`DELETE agentName FROM SystemSample WHERE entityKey = 'vagrant'`</td>
        </tr>
        <tr>
            <td>`StorageSample`</td>
            <td>`TBD`</td>
            <td>None</td>
            <td>N/A</td>
            <td>`entityAndMountPoint`</td>
            <td>`DELETE FROM StorageSample WHERE inodesUsed = 161604`</td>
        </tr>
        <tr>
            <td>`NetworkSample`</td>
            <td>`TBD`</td>
            <td>None</td>
            <td>N/A</td>
            <td>`entityAndInterface` (value same as `entityId`)</td>
            <td>`DELETE instanceType,inodesTotal NetworkSample WHERE entityKey = 'vagrant'`</td>
        </tr>
        <tr>
            <td>`ProcessSample`</td>
            <td>`TBD`</td>
            <td>None</td>
            <td>N/A</td>
            <td>`entityAndPid` (value same as `entityId`)</td>
            <td>`DELETE FROM ProcessSample WHERE entityKey = 'vagrant'`</td>
        </tr>
        <tr>
            <td>`ContainerSample`</td>
            <td>`TBD`</td>
            <td>None</td>
            <td>N/A</td>
            <td>`entityGuid`, `entityType`, `entityId`</td>
            <td>`DELETE FROM ContainerSample WHERE agentName='ContainerSampleAgent'`</td>
        </tr>
    </tbody>
</table>

