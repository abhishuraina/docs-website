---
title: Set up and deploy Pipeline Control gateway
metaDescription: 'Learn how to set up and deploy the Pipeline Control gateway to manage the flow of data from your monitored entities to New Relic.'
tags:
    - New Relic One
    - Pipeline control
---

## Set up Pipeline Control gateway [#set-up-pipeline-control-gateway]

To set-up Pipeline Control gateway:

1. In your New Relic account, go to **Integrations & Agents**, click **Set up Pipeline Control**, or search for “gateway” and select **Pipeline Control gateway**.  

    <callout variant="tip">
        By default, an account is selected when you log into New Relic. 
    </callout>

2. Ensure the selected account is the one you want to use for Pipeline Control. If not, click **Select an account**, choose the desired account, and then click **Continue**.

3. To enter your credentials, provide an existing license key or create a new one, and then click **Continue**.

4. Select an existing Kubernetes cluster using the drop-down menu, or create a new one.  
    
5. If you create a new cluster, enter the cluster name and namespace. The default namespace is `newrelic`.

6. Set **Minimum replicas** to a number between 1 and 10. The default is 2.

7. Set **Maximum replicas** to a number between 1 and 10. The default is 10.  

    <callout variant="tip">
        Maximum replicas must be greater than or equal to Minimum replicas. 
    </callout>

8. Set the **CPU usage threshold** to scale clusters.

9. Download the configuration file, `values-newrelic-gateway.yaml`, to a directory.

10. Run the installation command:

    ```bash
    helm repo add newrelic https://helm-charts.newrelic.com && helm repo update && \
    helm upgrade --install newrelic-gateway --version 0.0.41-beta -n newrelic \
    newrelic/agent-control --create-namespace --values /path/to/values-newrelic-gateway.yaml --devel
    ```

    <callout variant="tip">
        Replace `/path/to/values-newrelic-gateway.yaml` with the directory where the configuration file is located. 
    </callout>

11. Click **Continue**.

12. Click **Test connection**.


## Gateway fleet [#gateway-fleet]

When you create your first gateway cluster, a special fleet is also created. An org can only have one gateway fleet. To view details of the gateway fleet, go to New Relic Control and click Gateway. 

The gateway fleet can have multiple gateway clusters. The following use case explains why.

### Use case: Optimize data flow across multiple regions [#use-case]

Imagine you're a customer managing a sophisticated observability setup with New Relic. Your operations span multiple geographic regions, each with its own unique data management challenges. Specifically, you operate Kubernetes clusters across two primary regions: Region A and Region B.

**Objective:** Optimize data handling and reduce unnecessary data transfer to maximize efficiency and minimize costs.

**Current Setup:**

You already have a gateway cluster (GC1) deployed. Your data-producing Kubernetes clusters in Region A are configured to route all telemetry data through GC1. This setup allows you to filter out irrelevant data, ensuring that only critical signals are sent to the New Relic backend.

**Challenge with Region B:**

Your Kubernetes clusters in Region B also need data processing. You have considered utilizing GC1 for Region B's data, but this introduces several inefficiencies:

* Increased latency: Data sent from Region B to Region A adds delay, which can impact real-time monitoring capabilities.
* Higher costs: Inter-region data transfer incurs additional costs, increasing operational expenses.

**Solution: Deploy multiple gateway clusters**

1. **Option 1:** Route Region B's data through GC1.
    * Drawbacks: Increased latency and higher data transfer costs.

2. **Option 2:** Optimal Choice

    * Deploy a new gateway cluster (GC2) in Region B.
    * Configure your Kubernetes clusters in Region B to filter their data through GC2. This reduces the distance data travels, minimizes latency, and eliminates inter-region transfer fees.

**Outcome:**

* **Improved Performance:** With GC2 deployed locally in Region B, you significantly reduce data transmission delays, enhancing your ability to react swiftly to critical events.
* **Cost Efficiency:** By keeping data processing localized, you avoid unnecessary cross-region charges, effectively managing your operational budget.
* **Scalable Architecture:** Adding GC2 provides a scalable architecture ready to support future expansions or operational shifts.

This strategy of deploying multiple, region-specific gateway clusters helps maintain streamlined operations and ensures your data monitoring remains both effective and economical.
