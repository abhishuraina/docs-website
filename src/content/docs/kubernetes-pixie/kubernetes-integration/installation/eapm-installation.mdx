---
title: "New Relic eAPM integration"
tags:
    - Integrations
    - eBPF integration
    - eAPM
metaDescription: "Learn how to integrate the New Relic eAPM agent to your Kubernetes cluster."
freshnessValidatedDate: never
---


<Callout title="Preview">
We're still working on this feature, but we'd love for you to try it out!
This feature is currently provided as part of a preview pursuant to our [pre-release policies](https:/docs.newrelic.com/docs/licenses/license-information/referenced-policies/new-relic-pre-release-policy/).
</Callout>

The New Relic extended Application Performance Monitoring (eAPM) agent is an integration of the extended Berkeley Packet Filter (eBPF) technology into New Relic's platform. The eAPM agent offers a new method for monitoring Kubernetes services, allowing customers to monitor their services without the need for language-specific agents. The eAPM Agent collects data directly from the kernel, providing valuable insights into the performance of services running on the Kubernetes cluster.

The New Relic eAPM agent is installed on each node of the Kubernetes cluster. After installation, the eAPM Agent:

* Detects all services running on the Kubernetes cluster.
* Collect the necessary data from the kernel.
* Send the data to the New Relic platform.

You can view the eAPM instrumentation data in the APM UI to provide performance insights for the services running on the Kubernetes cluster.

<Callout variant="important" title="important">
You must upgrade to APM if you want to use one of the following features in your New Relic environment:

* Distributed tracing
* Multi-span transactions

</Callout>

This data is populate in the APM UI to provide the performance insights for the services running on the Kubernetes cluster.

Features of the eAPM integration include:

* **Zero-code instrumentation:** Simplifies the monitoring process by eliminating the need for manual code instrumentation, reducing deployment complexity, and maintenance overhead.
* **Comprehensive observability:** Enables detailed visibility into application and network performance, helping to quickly identify and resolve issues.
* **Low-resource overhead:** Operates efficiently with minimal impact on system resources, leveraging its position within the kernel.
* **Future security enhancements:** Lays the groundwork for advanced security features such as runtime threat detection and policy enforcement.


## Key differences between eAPM and APM

The eAPM integration is a new way to monitor Kubernetes services, offering a different approach to monitoring services compared to the traditional APM agent. The key differences between the eAPM and APM agents are:

<table>
  <thead>
    <tr>
      <th>Functionality</th>
      <th>eAPM Agent</th>
      <th>APM Agent</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Summary</td>
      <td>✔️</td>
      <td>✔️</td>
    </tr>
    <tr>
      <td>Transaction</td>
      <td>✔️</td>
      <td>✔️</td>
    </tr>
    <tr>
      <td>Database OPS</td>
      <td>✔️</td>
      <td>✔️</td>
    </tr>
    <tr>
      <td>External Service</td>
      <td>❌</td>
      <td>✔️</td>
    </tr>
    <tr>
      <td>Distributed Tracing</td>
      <td>❌</td>
      <td>✔️</td>
    </tr>
    <tr>
      <td>Service Logs</td>
      <td>❌</td>
      <td>✔️</td>
    </tr>
    <tr>
      <td>Trace Logs</td>
      <td>❌</td>
      <td>✔️</td>
    </tr>
    <tr>
      <td>Custom Instrumentation</td>
      <td>❌</td>
      <td>✔️</td>
    </tr>
    <tr>
      <td>Visualize Network Latency on Top of APM Transaction Latency</td>
      <td>❌</td>
      <td>✔️</td>
    </tr>
    <tr>
      <td>Deduplicate Data Ingestion from eBPF</td>
      <td>✔️</td>
      <td>✔️</td>
    </tr>
    <tr>
      <td>Linux Support</td>
      <td>✔️</td>
      <td>✔️</td>
    </tr>
    <tr>
      <td>Windows Support</td>
      <td>❌</td>
      <td>✔️</td>
    </tr>
    <tr>
      <td>Instrumentation</td>
      <td>Auto discovery</td>
      <td>Auto-attach</td>
    </tr>
    <tr>
      <td>Agent</td>
      <td>One per Node</td>
      <td>One per App</td>
    </tr>
    <tr>
      <td>Telemetry Data Source</td>
      <td>eBPF</td>
      <td>APM language Agent</td>
    </tr>
  </tbody>
</table>


### Installation prerequisites [#prerequisites]

* Ensure that your Linux kernel version is v4.14 or above.
* Ensure that all [Kubernetes integration compatibility and requirements](/docs/kubernetes-pixie/kubernetes-integration/get-started/kubernetes-integration-compatibility-requirements/) are met.


## Installation of eAPM agent [#installation]

A New Relic eAPM agent is installed on each node of your cluster. You can install the eAPM agent on your existing Kubernetes cluster using one of the following methods:

- [Guided installation](#guided-installation)
- [Manual installation](#manual-installation)


### Guided installation [#guided-installation]

The guided installation method is the easiest way to install the eAPM agent on your Kubernetes cluster. It offers pre-built resources and configurations to simplify the installation process.  

**To install the eAPM agent:**

1. Log in to your New Relic account.
2. Go to **+ Integration & Agents > Guided install > Kubernetes**.
2. Select the instrumentation method from one of the following displayed options:

   - **Guided**: For integration using New Relic CLI.
   - **Helm**: For integration using New Relic Helm charts.
   - **Manifest**: For integration using New Relic Manifests.

3. Click **Continue**.
4. On the **Enter your user key** screen, select one of the following options, then click **Continue**:

   - **Use an existing key**: If you already have a user key, provide the user key. For more information, refer to [User keys](#).
   - **Create a new key**: If you don't have a user key, click **Create a new key** to create one.

5. On the **Configure the Kubernetes integration** screen, enter the following information, then click **Continue**:

   - **Choose a Kubernetes cluster name**: Enter your Kubernetes cluster name. This name must be the same as your Kubernetes cluster name. If the cluster is already instrumented in New Relic, select the cluster from the drop-down list.
   - **Namespace for the integration**: Enter the namespace for the integration. The default namespace is `newrelic`.
   - **Configure the Kubernetes operation mode**: If you are using the Google Kubernetes Engine (GKE), enable the **Are you using a GKE Autopilot cluster?** option.

6. On the **Scrape Prometheus data** screen, select the applicable Prometheus data you want to scrape, then click **Continue**.
7. (Optional) On the **Enable APM auto-instrumentation** screen, if required, enable the **Activate APM auto-attach**, and then click **Continue**. For more information, refer to [APM auto-instrumentation](#).
8. On the **Gather Log data** screen, select the applicable options to forward log data, then click **Continue**.
9. On the **Install the Kubernetes integration** screen, click **Copy to clipboard**, then paste it to your host terminal.
10. After the installation is completed, click **Continue**.
11. (Optional) If you have enabled the APM auto-instrumentation, the **Configure APM auto-instrumentation** screen displays. Set the APM auto-instrumentation parameters as required, then click **Continue**.
12. After the New Relic eBPF agent is installed on your cluster, click **Continue**.
13. On the **Test the connection** screen, click **Test connection** to verify the installation.

    <Callout variant="tip" title="tip">

    During the installation, the eAPM agent is installed on each node of your cluster. For example, if you have three nodes in a Kubernetes cluster, then one eAPM agent is installed on each node. No additional configuration is required for this.

    </Callout>


## Manual Installation
Add the New Relic eAPM Helm chart to your existing Kubernetes cluster.

### Prerequisites:

- Download the [`value.yaml`](https://github.com/newrelic/helm-charts/blob/master/charts/nr-ebpf-agent/values.yaml) file.
- You must have a valid New Relic ingest key. For more information, refer to [New Relic Keys](https://docs.newrelic.com/docs/apis/intro-apis/new-relic-api-keys/).

### To manually install the eAPM agent:

1. Open the [`value.yaml`](https://github.com/newrelic/helm-charts/blob/master/charts/nr-ebpf-agent/values.yaml) file in your code editor.
2. Enter your Kubernetes cluster name for the `cluster` attribute. This name must be the same as your Kubernetes cluster name.
3. Add the New Relic ingest key for the `licenseKey` attribute.
4. Save the `value.yaml` file in your Kubernetes cluster.
5. To add the New Relic Helm chart repository, run:

  ```sh
  
  helm repo add newrelic https://helm-charts.newrelic.com
  
  ```

6. To install the eAPM agent Helm chart, replace `your-custom-values.yaml` with the path to your `values.yaml` file, run:

  ```sh
  
  helm upgrade nr-ebpf-agent newrelic/nr-ebpf-agent -f your-custom-values.yaml -n newrelic --create-namespace --install
  
  ```
7. (Optional) To view pod deployment status in real-time, run:
  
    ```sh
    
    kubectl get pods -n newrelic --watch
    
    ```



## Access the eBPF-powered APM UI [#ebpf-access]

To access the eBPF-powered APM UI:

1. Go to [https://one.newrelic.com](https://one.newrelic.com) > **APM & Services**.
2. In the search banner, set the search criteria as `instrumentation.name = nr_ebpf`:
    <img
    title="eBPF Search"
    alt="A screenshot showing the eBPF search bar"
    src="/images/ebpf_filters.webp"
    />
    After the search is completed, a list of entity is displayed. The service entity name is the same as Kubernetes service name. 
    <Callout variant="tip" title="TIP">
    Some entities may display an IP address, such as 10.0.10.1, instead of a service name such as shopping-cart-service. This occurs because eAPM cannot resolve these service names via Kubernetes metadata and must use IP addresses.
    </Callout>


### Find and use data [#ui-screen]

The New Relic APM experience is populated using data generated by the eAPM agent, without any additional custom instrumentation to your codebase.

{/* The following is a description of how the UI will behave:

#### Summary page [#ebpf-summary]

|Component | eBPF-powered APM Limited Preview |
|---|---| 
|Chart: Web Transaction Time|✅ Metric: apm.service.transaction.duration synthesized via eBPF data|
|Chart: Apdex| ✅ Supported |
|Chart: Throughput |✅ Metric: apm.service.transaction.duration synthesized via eBPF data|
|Chart: Error Rate| ✅ Metric: Metric: apm.service.error.count synthesized via eBPF data|
|Table: Transactions|Only showcase HTTP methods. Will include URL routes next|
|Component: Distributed Tracing Insights|Not available in LP|

#### Transactions [#ebpf-transactions]

|Component | eBPF-powered APM Limited Preview |
|---|---| 
|Billboards: Transaction overview|✅ Most time consuming 
| | Slowest avg response time |
| | Highest error rate |
| | Highest throughput |
| | Apdex by most dissatisfying |
|Chart: Top 20 Transactions | Only HTTP methods are shown |
|Chart: Time consumed by top transactions (Average)| Note that the chart here does not distinguish between Web or Others (NR APM does).|
|Chart: Time consumed by top Web transactions (Histogram)|✅Per histograms reported by eBPF|
|Chart: Time consumed by top Web transactions (Percentiles)|✅Supported|
|Chart: Throughput|Area chart powered by the metric apm.service.transaction.duration|
|Table: Transaction traces|Not supported in LP| */}

## Pricing information

Your use of the New Relic eAPM agent is billable in accordance with your Order as part of the New Relic Compute pricing model. The costs associated with this feature are determined by the following factors:

* **Data Ingest:** Charges are incurred based on the volume of data ingested, measured in GB. This includes all data collected by the eAPM agent and transmitted to the New Relic platform.
* **APM UI Usage:** Charges are also incurred based on the utilization of the APM User Interface, measured in Compute Capacity Units (CCU).

New Relic intends to maintain the eAPM agent as a feature within the New Relic Compute pricing model.

For further details on pricing, please contact our sales team or refer to your Order.


