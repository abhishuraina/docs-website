---
title: Guide to using the Roku agent API
tags:
translate:
metaDescription: 'Detailed New Relic Roku Agent API, covering initialization, event logging, and metric recording for Roku applications. Includes function descriptions and usage examples.'
redirects:
freshnessValidatedDate: never
---

## Overview

The New Relic Roku agent is designed to monitor system and video events in Roku applications. It provides a comprehensive API for tracking various types of events, including system, video, error, ad, and custom events. This document outlines the API methods available for interacting with the New Relic Roku Agent.

### Key Functions

- **NewRelic**: Initializes the agent.
- **NewRelicSystemStart**: Starts system logging.
- **NewRelicVideoStart**: Begins video logging.
- **nrProcessMessage**: Processes system log messages.
- **nrSetCustomAttribute**: Sets a custom attribute for events.
- **nrSendCustomEvent**: Sends a custom event.
- **nrSendSystemEvent**: Sends a system event.
- **nrSendVideoEvent**: Sends a video event.

### NewRelic

```brightscript
NewRelic(account as String, apikey as String, region = "US" as String, activeLogs = false as Boolean) as Object
```

- **Description**: Initializes a New Relic Agent object.
- **Arguments**:
  - `account`: New Relic account number.
  - `apikey`: API key.
  - `region`: (Optional) New Relic API region, either "EU" or "US". Default is "US".
  - `activeLogs`: (Optional) Activate logs or not. Default is `false`.
- **Returns**: New Relic Agent object.
- **Example**:

  ```brightscript
  sub Main(aa as Object)
      screen = CreateObject("roSGScreen")
      m.port = CreateObject("roMessagePort")
      screen.setMessagePort(m.port)
      scene = screen.CreateScene("VideoScene")
      screen.show()
  
      m.nr = NewRelic("ACCOUNT ID", "API KEY")
  ```

### NewRelicSystemStart

```brightscript
NewRelicSystemStart(port as Object) as Object
```

- **Description**: Starts system logging.
- **Arguments**: `port`: A message port.
- **Returns**: The `roSystemLog` object created.
- **Example**:

  ```brightscript
  m.syslog = NewRelicSystemStart(m.port)
  ```

### NewRelicVideoStart

```brightscript
NewRelicVideoStart(nr as Object, video as Object) as Void
```

- **Description**: Starts video logging.
- **Arguments**:
  - `nr`: New Relic Agent object.
  - `video`: A video object.
- **Returns**: Nothing.
- **Example**:

  ```brightscript
  NewRelicVideoStart(m.nr, m.video)
  ```

### NewRelicVideoStop

```brightscript
NewRelicVideoStop(nr as Object) as Void
```

- **Description**: Stops video logging.
- **Arguments**: `nr`: New Relic Agent object.
- **Returns**: Nothing.
- **Example**:

  ```brightscript
  NewRelicVideoStop(m.nr)
  ```

### nrProcessMessage

```brightscript
nrProcessMessage(nr as Object, msg as Object) as Boolean
```

- **Description**: Checks for a system log message, processes it, and sends the appropriate event.
- **Arguments**:
  - `nr`: New Relic Agent object.
  - `msg`: A message of type `roSystemLogEvent`.
- **Returns**: `True` if `msg` is a system log message, `False` otherwise.
- **Example**:

  ```brightscript
  while (true)
      msg = wait(0, m.port)
      if nrProcessMessage(m.nr, msg) = false
          if type(msg) = "roPosterScreenEvent"
              if msg.isScreenClosed()
                  exit while
              end if
          end if
      end if
  end while
  ```

### nrSetCustomAttribute

```brightscript
nrSetCustomAttribute(nr as Object, key as String, value as Object, actionName = "" as String) as Void
```

- **Description**: Sets a custom attribute to be included in the events.
- **Arguments**:
  - `nr`: New Relic Agent object.
  - `key`: Attribute name.
  - `value`: Attribute value.
  - `actionName`: (Optional) Action where the attribute will be included. Default is all actions.
- **Returns**: Nothing.
- **Example**:

  ```brightscript
  nrSetCustomAttribute(m.nr, "myNum", 123, "CONTENT_START")
  nrSetCustomAttribute(m.nr, "myString", "hello")
  ```

### nrSetCustomAttributeList

```brightscript
nrSetCustomAttributeList(nr as Object, attr as Object, actionName = "" as String) as Void
```

- **Description**: Sets a custom attribute list to be included in the events.
- **Arguments**:
  - `nr`: New Relic Agent object.
  - `attr`: Attribute list, as an associative array.
  - `actionName`: (Optional)

To understand which actions and attributes are captured and emitted by the Dash Player under different event types, see [Data dictionary]().