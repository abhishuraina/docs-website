---
headingText: Enable query monitoring
componentType: default
---

You can view query-level analysis to monitor your SQL queries within your PostgreSQL database to assess their performance and impact. This feature provides insights into execution times, resource consumption, and potential bottlenecks, enabling you to optimize database operations. For more information, see [Query-Level Analysis](#).

**Prerequisites:**

* Ensure that your PostgreSQL version is 12 or higher.
* You must enable the `pg_stat_statements` extension. For more information, refer [Enabling extensions](#enabling-extensions).

<Callout variant="important">
To enable these extension, PostgreSQL version should be 12 or higher.

pg_stat_monitor and pg_wait_sampling extensions doesnt support windows
</Callout>


1. To retrieve slow running queries and blocking sessions, install the `pg_stat_statements` extension:

    1. Open the `postgresql.conf` file:

        ```shell
        C:\Program Files\PostgreSQL\<version>\data\postgresql.conf
        ```
    2. Add extensions to shared_preload_libraries in `postgresql.conf`

        ```shell
        shared_preload_libraries = 'pg_stat_statements'
        pg_stat_statements.max = 10000    # Maximum number of statements tracked
        pg_stat_statements.track = all    # Track all statements
        pg_stat_statements.save = on      # Save statistics across server restarts
        ```

2. Restart the PostgreSQL server, run:

    ```shell
    net stop postgresql-x64-<version>
    net start postgresql-x64-<version>
    ```

3. Connect to the PostgreSQL server, run:

    ```shell
    psql -U postgres
    ```

4. Enable the extensions for your database, run:

    ```shell
    CREATE EXTENSION pg_stat_statements;
    ```

5. Grant the required permissions, run:

    ```shell
    psql -U postgres
    GRANT pg_read_all_stats TO newrelic;
    GRANT SELECT ON ALL TABLES IN SCHEMA public TO your_username;
    ```