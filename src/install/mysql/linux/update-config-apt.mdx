---
componentType: default
headingText: Enable MySQL Performance Schema
---

Instructions for enabling the Performance Schema in your MySQL configuration file (such as my.cnf or similar), allowing the New Relic MySQL integration to gather this data.
<Callout variant="important">
Query Performance Monitoring feature is only supported on MySQL versions 8.0 and higher. Ensure your MySQL version meets this requirement before proceeding.
</Callout>

1. Add the following lines to your MySQL configuration file (e.g., `/etc/mysql/mysql.conf.d/mysqld.cnf` or `/etc/mysql/my.cnf` for <DNT>**Debian/Ubuntu**</DNT>):
   ```ini
   [mysqld]
    performance_schema=ON

    # Specify an initialization file for Debian/Ubuntu
    init-file = /etc/mysql/init.sql
   ```
2. Create a file named `init.sql` in the directory specified in the previous step (e.g., `/etc/mysql/` for <DNT>**Debian/Ubuntu**</DNT>, `/etc/` for <DNT>**RHEL/CentOS/Amazon Linux/Oracle Linux**</DNT>) with the following content:
   ```sql
    -- Enable required Performance Schema instruments
    UPDATE performance_schema.setup_instruments
    SET ENABLED = 'YES', TIMED = 'YES'
    WHERE NAME LIKE 'wait/%' OR NAME LIKE 'statement/%' OR NAME LIKE '%lock%';

    UPDATE performance_schema.setup_consumers
    SET ENABLED = 'YES'
    WHERE NAME IN (
    'events_waits_current', 'events_waits_history_long',
    'events_waits_history',
    'events_statements_history_long',
    'events_statements_history', 'events_statements_current', 
    'events_statements_cpu'
    ) OR NAME LIKE 'events_waits_current%' OR NAME LIKE 'events_transactions_current%' 
    OR NAME LIKE 'events_stages_current%';

    -- Increase Innodb lock wait timeout
    SET GLOBAL innodb_lock_wait_timeout = 120;
   ```
3. Restart the MySQL server to apply the changes made to the configuration file:
   ```shell
    sudo systemctl restart mysql
   ```
4. Verify the MySQL server status:
   ```shell
    sudo systemctl status mysql
   ```