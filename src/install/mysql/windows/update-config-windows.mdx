---
componentType: default
headingText: Enable MySQL Performance Schema
---

Instructions for enabling the Performance Schema in your MySQL configuration file (such as my.ini or similar), allowing the New Relic MySQL integration to gather this data.
<Callout variant="important">
Query Performance Monitoring feature is only supported on MySQL versions 8.0 and higher. Ensure your MySQL version meets this requirement before proceeding.
</Callout>

1. Add the following lines to your MySQL configuration file (e.g., `C:\ProgramData\MySQL\MySQL Server 8.0\my.ini` or similar):
   ```ini
   [mysqld]
    performance_schema=ON

    # Specify an initialization file
    init-file = C:\ProgramData\MySQL\MySQL Server 8.0\init.sql
   ```
2. Create a file named `init.sql` in the directory specified in the previous step (e.g., `C:\ProgramData\MySQL\MySQL Server 8.0\`) with the following content:
   ```sql
    -- Enable required Performance Schema instruments
    UPDATE performance_schema.setup_instruments
    SET ENABLED = 'YES', TIMED = 'YES'
    WHERE NAME LIKE 'wait/%' OR NAME LIKE 'statement/%' OR NAME LIKE '%lock%';

    UPDATE performance_schema.setup_consumers
    SET ENABLED = 'YES'
    WHERE NAME IN (
    'events_waits_current', 'events_waits_history_long',
    'events_waits_history',
    'events_statements_history_long',
    'events_statements_history', 'events_statements_current', 
    'events_statements_cpu'
    ) OR NAME LIKE 'events_waits_current%' OR NAME LIKE 'events_transactions_current%' 
    OR NAME LIKE 'events_stages_current%';

    -- Increase Innodb lock wait timeout
    SET GLOBAL innodb_lock_wait_timeout = 120;
   ```

3. Restart the MySQL server to apply the changes made to the configuration file (update service name as needed):
   ```shell
    Restart-Service -Name "MySQL80"
   ```
4. Verify the MySQL server status (update service name as needed):
   ```shell
    Get-Service -Name "MySQL80"
   ```